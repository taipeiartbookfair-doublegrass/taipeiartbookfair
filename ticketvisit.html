<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>è³¼ç¥¨åƒè§€ | Taipei Art Book Fair Visit</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=BioRhyme+Expanded:wght@200;300;400;700;800&family=Libre+Franklin:ital,wght@0,100..900;1,100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="shortcut icon" href="image/icon-1.ico" />
    <link rel="stylesheet" href="css/font.css" />
    <link rel="stylesheet" href="css/ticketvisit.css">
    <script src="js/ticketmagic.js"></script>
    <script src="js/ticketvisitupdate.js"></script>
  </head>
  <body>
    <!-- é ‚éƒ¨å°èˆª -->
    <nav class="top-navigation">
      <div class="nav-container">
        <a href="index.html" class="nav-back-btn" data-zh="â† è¿”å›" data-en="â† Back">â† è¿”å›</a>
        
        <ul class="nav-menu">
          <li><a href="#general-info" class="nav-item">GENERAL INFO</a></li>
          <li><a href="#access" class="nav-item">ACCESS</a></li>
          <li><a href="#tickets" class="nav-item">TICKETS</a></li>
          <li><a href="#timeline" class="nav-item">PROGRAMS</a></li>
          <li><a href="#exhibitors" class="nav-item">EXHIBITORS</a></li>
          <button id="lang-btn" class="nav-lang">EN</button>
        </ul>
      </div>
    </nav>
    
    <!-- å›åˆ°é ‚éƒ¨æŒ‰éˆ• -->
    <button id="backToTop" class="back-to-top-btn">
      â†‘
    </button>
    

    <!-- ä¸»è¦–è¦ºå€åŸŸ -->
    <section class="hero-section">
      <div class="hero-container">
        <!-- å½±ç‰‡å€åŸŸ - å–®ç¨ä½”æ»¿æ•´è¡Œ -->
        <div class="hero-poster-section">
         <iframe 
           id="hero-video"
           src="" 
           width="100%" 
           height="100%" 
           frameborder="0" 
           allow="autoplay; fullscreen; picture-in-picture" 
           allowfullscreen>
          </iframe>
        </div>
      </div>
    </section>

    <!-- äº¤é€šè³‡è¨Šå€åŸŸ - ç¨ç«‹çš„ section -->
    <section class="hero-traffic" id="general-info">
          <!-- å±•è¦½è³‡è¨Šå€åŸŸ -->
          <div class="exhibition-info-section">
            <h2 id="exhibition-title" class="exhibition-title"></h2>
            <p id="exhibition-subtitle" class="exhibition-subtitle"></p>
            <p>
              <mark id="exhibition-poem" class="exhibition-poem" style="font-size:.9rem; margin-bottom:10px;">
              </mark>
              </p>         
          </div>

          <div class="exhibition-details">
            <div class="detail-item">
              <h3 class="detail-item-title">æ™‚é–“ Time</h3>
              <ul id="time-list" class="time-list" >
                
              </ul>
            </div>
            
            <div class="detail-item">
              <h3 class="detail-item-title">æ´»å‹•åœ°é» Location</h3>
              <p><a id="location" href="" target="_blank"></a></p>
              <div class="map-container" id="googlemap">
                <iframe 
                src="" 
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade">
                </iframe>
              </div>
            </div>
            
            <div class="detail-item">
              <h3 class="detail-item-title">å³æ™‚è³‡è¨Š Info Log</h3>
            </div>
            <div id="info-log" style="background-color:white;border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;border-top:none;">ğŸš§ è®€å–ä¸­â€¦</div>
          </div>
          
          <div class="access-info-section" id="access">
            
          <h2 class="access-section-title">Access</h2>
          
          <div class="access-info">
            <h3 data-zh="æ·é‹" data-en="MRT">æ·é‹</h3>
            <p id="mrt-info"></p>
            
            <h3 data-zh="å…¬è»Š" data-en="Bus">å…¬è»Š</h3>
            <p id="bus-info"></p>
            
            <h3 data-zh="è‡ªè¡Œé–‹è»Š" data-en="By Car">è‡ªè¡Œé–‹è»Š</h3>
            <p id="by-car-info"></p>
              
            <h3 data-zh="YouBike" data-en="YouBike">YouBike</h3>
            <p id="youbike-info"></p>
        </div>
      </div>
    </section>

    <!-- å…©æ¬„å¸ƒå±€ï¼šTickets | FAQ -->
    <section class="two-column-section" id="tickets">
      <div class="two-column-container">
        <!-- å·¦æ¬„ï¼šTickets (ä½”2/3) -->
        <div class="column tickets-column">
          <h2 class="column-title">Ticket Information</h2>
            <div class="tickets-grid">
              
            </div>
         </div>
         <!-- å³æ¬„ï¼šFAQ -->
        <div class="column">
          <h2 class="column-title">FAQ</h2>
          <div class="faq-container">
            <!-- FAQ é …ç›®å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
          </div>
        </div>
      </div>
    </section>

    <!-- Timeline å€åŸŸ -->
    <section class="timeline-section" id="timeline">
      <div class="timeline-container">
        <h2 class="timeline-title">Programs</h2>
        
        <!-- Subscribe to Calendar - ç›´æ¥æ”¾åœ¨æ¨™é¡Œä¸‹æ–¹ -->
        <div class="timeline-subscribe">
          <p class="agenda-subscribe">
            <a
              href="https://calendar.google.com/calendar/u/2?cid=OTA1MjdmNjdmYTQ2MmM4M2UxODRiMGM2MmRlZjEwZWJjOGIwMGNjOGM2N2E1YjgzYWYyYWZiOTBhMWJkYjI5M0Bncm91cC5jYWxlbmRhci5nb29nbGUuY29t"
              >\Suscribe to TPABF's calendar/</a
            >
          </p>
        </div>

        <div class="timeline-instructions" data-zh="æ“ä½œèªªæ˜ï¼š1) é»æ“Šä¸‹æ–¹æ™‚é–“è»¸ä¸Šçš„æ´»å‹•é …ç›®æŸ¥çœ‹è©³ç´°è³‡è¨Šã€‚2) æ´»å‹•è©³æƒ…æœƒé¡¯ç¤ºåœ¨å³å´é è¦½å€ï¼Œè«‹å‘å³æ»‘å‹•æˆ–é»æ“Šæ´»å‹•å¾Œæœƒè‡ªå‹•æ»¾å‹•è‡³é è¦½å€ã€‚3) ä½¿ç”¨ä¸Šæ–¹çš„æ´»å‹•é¡å‹æŒ‰éˆ•ï¼ˆALLã€TALKã€WORKSHOPã€PERFORMANCEï¼‰å¯å¿«é€Ÿç¯©é¸ç‰¹å®šé¡å‹çš„æ´»å‹•ã€‚" data-en="Instructions: 1) Click on any event item in the timeline below to view detailed information. 2) Event details will appear in the preview area on the right. Swipe right or the container will automatically scroll to the preview area after clicking an event. 3) Use the event type filter buttons at the top (ALL, TALK, WORKSHOP, PERFORMANCE) to quickly filter events by type.">
          æ“ä½œèªªæ˜ï¼š1) é»æ“Šä¸‹æ–¹æ™‚é–“è»¸ä¸Šçš„æ´»å‹•é …ç›®æŸ¥çœ‹è©³ç´°è³‡è¨Šã€‚2) æ´»å‹•è©³æƒ…æœƒé¡¯ç¤ºåœ¨å³å´é è¦½å€ï¼Œè«‹å‘å³æ»‘å‹•æˆ–é»æ“Šæ´»å‹•å¾Œæœƒè‡ªå‹•æ»¾å‹•è‡³é è¦½å€ã€‚3) ä½¿ç”¨ä¸Šæ–¹çš„æ´»å‹•é¡å‹æŒ‰éˆ•ï¼ˆALLã€TALKã€WORKSHOPã€PERFORMANCEï¼‰å¯å¿«é€Ÿç¯©é¸ç‰¹å®šé¡å‹çš„æ´»å‹•ã€‚
        </div>
        
        <!-- Agenda æ¨™é¡Œè¡Œ -->
        <div class="agenda-header">
          <div class="agenda-controls">
          </div>
        </div>
        
        <!-- æ™‚é–“è»¸æ¨¡å¼å®¹å™¨ - ç¢ºä¿IDæ­£ç¢ºä¸”å§‹çµ‚é¡¯ç¤º -->
        <div
          class="timeline-mode-container"
          id="timelineModeContainer"
        >
        <div id="timeline-coming-soon" class="coming-soon-mask" style="display:absolute;">
          <span>COMING SOON</span>
        </div>
          <div class="timeline-scroll-container" id="timelineScroll">
            <div class="timeline-calendar" id="timelineCalendar">
              <!-- æ™‚é–“è»¸æ—¥æ›†å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
      </div>          
          </div>
          </div>
    </section>

    <!-- Exhibitor å€åŸŸ -->
    <section class="exhibitor-section" id="exhibitors">
      <div class="exhibitor-container">
        <h2 class="exhibitor-title">Exhibitors</h2>
        
        <!-- æœå°‹å’Œç¯©é¸æ§åˆ¶é¢æ¿ -->
        <div class="exhibitor-search-panel">
          <!-- æœå°‹è¼¸å…¥æ¡† -->
          <div class="search-section">
            <div class="search-input-container">
              <input 
                type="text" 
                id="exhibitor-search-input" 
                class="search-input" 
                placeholder="SEARCH..." 
                data-zh="SEARCH..." 
                data-en="SEARCH..."
              />
              <button id="search-clear-btn" class="search-clear-btn" title="æ¸…ç©ºæœå°‹">Ã—</button>
            </div>
          </div>
          
          <!-- æ’åºæŒ‰éˆ•çµ„ -->
          <div class="filter-section">
            <ul id="sort_button" class="sort_button" data-sort="atoz">
              <li data-label="atoz" class="sort-btn active" data-zh="A-Z" data-en="A-Z">A-Z</li>
              <li data-label="zone" class="sort-btn" data-zh="ZONE" data-en="ZONE">ZONE</li>
              <li data-label="country" class="sort-btn" data-zh="COUNTRY" data-en="COUNTRY">COUNTRY</li>
              <li data-label="length" class="sort-btn" data-zh="å­—æ•¸" data-en="LENGTH">LENGTH</li>
            </ul>
          </div>
        </div>
        
        <!-- åŸæœ‰çš„ç¯©é¸å™¨æ§åˆ¶é¢æ¿ï¼ˆä¿ç•™ä½œç‚ºå‚™ç”¨ï¼‰ -->
        <div class="exhibitor-filters">
          <div class="filter-buttons">
            <button id="sort-name-btn" class="filter-btn active" data-zh="å“ç‰Œåç¨± A-Z" data-en="Brand Name A-Z">å“ç‰Œåç¨± A-Z</button>
            <button id="sort-country-btn" class="filter-btn" data-zh="åœ‹ç±" data-en="Country">åœ‹ç±</button>
            <button id="sort-number-btn" class="filter-btn" data-zh="æ”¤å•†ç·¨è™Ÿ A-Z" data-en="Booth Number A-Z">æ”¤å•†ç·¨è™Ÿ A-Z</button>
          </div>
        </div>
        
        <!-- æ”¤å•†è³‡è¨Šé¡¯ç¤ºå€åŸŸ -->
        <div class="exhibitor-info-content">
          <div id="exhibitor-coming-soon" class="coming-soon-mask" style="display:absolute;">
          <span>COMING SOON</span>
        </div>
        
          <div id="exhibitor-map-container" class="exhibitor-map-container">
            <div class="exhibitor-map-header">
              <span class="exhibitor-map-title" data-zh="æ”¤ä½åœ°åœ– Booth Map" data-en="Booth Map">æ”¤ä½åœ°åœ– Booth Map</span>
            </div>
            <div class="exhibitor-map-resize-handle"></div>
            <img src="image/exhibitormap.jpg" alt="Exhibitor Map" class="exhibitor-map-image" id="exhibitor-map-image" />
          </div>
          
          <div class="exhibitor-display-container" id="exhibitorDisplayContainer">
            <div class="exhibitors-grid-main">
              <!-- åƒå±•å•†å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
          </div>
          </div>
          
        <!-- æ”¤å•†åå–®å±•é–‹å€åŸŸ -->
        <div class="exhibitor-full-list" id="exhibitorFullList">
          <!-- é ‚éƒ¨æ§åˆ¶å€åŸŸ -->
          <div class="exhibitor-top-controls">
            <div class="exhibitor-expand-btn" id="exhibitorExpandBtn">
              <span class="expand-text">æ”¤å•†</span>
              <span class="expand-arrow">â†“</span>
          </div>
          
            <!-- æ’åºæŒ‰éˆ• -->
            <div class="exhibitor-sort-buttons">
              <button class="sort-button active" data-sort="country">COUNTRY</button>
              <button class="sort-button" data-sort="zone">ZONE</button>
              <button class="sort-button" data-sort="name">NAME</button>
          </div>
          </div>
          
          <div class="exhibitors-grid"></div>
          </div>
          </div>
    </section>

    <!-- Credit/Team å€åŸŸ -->
    <!-- <section class="credit-section">
      <div class="credit-container">
        <h2 class="credit-title" data-zh="è£½ä½œåœ˜éšŠ" data-en="Credits">è£½ä½œåœ˜éšŠ</h2>
       
        </div>
    </section> -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // èªè¨€åˆ‡æ›åŠŸèƒ½
        function initLanguageSwitch() {
          const langBtn = document.getElementById("lang-btn");

          function switchLanguage() {
            // æ ¹æ“šæŒ‰éˆ•æ–‡å­—åˆ¤æ–·ç•¶å‰èªè¨€ä¸¦åˆ‡æ›
            const isCurrentlyZh = langBtn.textContent === "EN";
            const newLang = isCurrentlyZh ? "en" : "zh";

            // æ›´æ–°æŒ‰éˆ•æ–‡å­—
            langBtn.textContent = newLang === "zh" ? "EN" : "ä¸­æ–‡";

            // æ›´æ–°æ‰€æœ‰æœ‰ç¿»è­¯å±¬æ€§çš„å…ƒç´ 
            const elementsWithTranslation =
              document.querySelectorAll("[data-zh][data-en]");
            elementsWithTranslation.forEach((element) => {
              const text = element.getAttribute(`data-${newLang}`);
              if (text) {
                element.innerHTML = text;
              }
            });

            // æ›´æ–°å‹•æ…‹ç¥¨åˆ¸ç‹€æ…‹
            updateTicketStatusLanguage(newLang);
          }

          langBtn.addEventListener("click", switchLanguage);
        }

        // æ›´æ–°ç¥¨åˆ¸ç‹€æ…‹çš„èªè¨€
        function updateTicketStatusLanguage(lang) {
          const statusElements = document.querySelectorAll('.ticket-status');
          const buttonElements = document.querySelectorAll('.ticket-btn');
          
          
          statusElements.forEach(statusElement => {
            const currentText = statusElement.textContent.trim();
            
            if (currentText === 'é–‹æ”¾ä¸­' || currentText === 'Available') {
              statusElement.textContent = lang === 'zh' ? 'é–‹æ”¾ä¸­' : 'Available';
            } else if (currentText === 'æœªé–‹æ”¾' || currentText === 'Not Yet Available') {
              statusElement.textContent = lang === 'zh' ? 'æœªé–‹æ”¾' : 'Not Yet Available';
            } else if (currentText === 'ç¾å ´è³¼è²·' || currentText === 'On-site Purchase') {
              statusElement.textContent = lang === 'zh' ? 'ç¾å ´è³¼è²·' : 'On-site Purchase';
            }
          });

          buttonElements.forEach(buttonElement => {
            const currentText = buttonElement.textContent.trim();
            if (currentText === 'ç«‹å³è³¼ç¥¨' || currentText === 'Buy Now') {
              buttonElement.textContent = lang === 'zh' ? 'ç«‹å³è³¼ç¥¨' : 'Buy Now';
            } else if (currentText === 'æœªé–‹æ”¾' || currentText === 'Not Available') {
              buttonElement.textContent = lang === 'zh' ? 'æœªé–‹æ”¾' : 'Not Available';
            }
          });
        }

        // ç¥¨åˆ¸ç‹€æ…‹å‹•æ…‹æ§åˆ¶
        function updateTicketStatus() {
          const currentDate = new Date();
        }

        // ç¥¨åˆ¸ç‹€æ…‹å‹•æ…‹æ§åˆ¶ï¼ˆæ”¹ç‚ºä»¥ DOM data-* é©…å‹•ï¼Œæˆ–å§”ç”± apply-tickets.js è™•ç†ï¼‰
        function updateTicketStatus() {
          // è‹¥å¤–éƒ¨è…³æœ¬æœ‰æä¾› updateTicketStatusFromDOMï¼Œç›´æ¥å‘¼å«å®ƒ
          if (typeof window.updateTicketStatusFromDOM === "function") {
            window.updateTicketStatusFromDOM();
            return;
          }
      
          // fallbackï¼šæ ¹æ“š DOM ä¸Šçš„ data-start-iso / data-end-iso åˆ¤æ–·ç‹€æ…‹
          const now = new Date();
          const isEN = document.documentElement.lang && document.documentElement.lang.startsWith("en");
          document.querySelectorAll('.ticket-card').forEach(card => {
            const startIso = card.dataset.startIso || card.dataset.start || "";
            const endIso = card.dataset.endIso || card.dataset.end || "";
            const start = startIso ? new Date(startIso) : null;
            const end = endIso ? new Date(endIso) : null;
            const statusEl = card.querySelector('.ticket-status');
            const btn = card.querySelector('.ticket-btn');
            const type = (card.getAttribute('data-ticket-type') || '').toLowerCase();
      
            if (type.includes('onsite')) {
              if (statusEl) statusEl.textContent = isEN ? 'On-site Purchase' : 'ç¾å ´è³¼è²·';
              if (btn) btn.style.display = 'none';
              return;
            }
      
            const available = start && end && now >= start && now <= end;
            if (available) {
              if (statusEl) statusEl.textContent = isEN ? 'Available' : 'é–‹æ”¾ä¸­';
              if (btn) { btn.textContent = isEN ? 'Buy Now' : 'ç«‹å³è³¼ç¥¨'; btn.classList.add('available'); btn.style.pointerEvents = ''; }
            } else {
              if (statusEl) statusEl.textContent = isEN ? 'Not Yet Available' : 'æœªé–‹æ”¾';
              if (btn) { btn.textContent = isEN ? 'Not Available' : 'æœªé–‹æ”¾'; btn.classList.remove('available'); btn.style.pointerEvents = 'none'; }
            }
          });
        }

        // å¹³æ»‘æ»¾å‹•åŠŸèƒ½
        function initSmoothScroll() {
          const navLinks = document.querySelectorAll('.nav-item[href^="#"]');
          
          navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
              e.preventDefault();
              const targetId = this.getAttribute('href');
              const targetElement = document.querySelector(targetId);
              
              if (targetElement) {
                targetElement.scrollIntoView({
                  behavior: 'smooth',
                  block: 'start'
                });
              }
            });
          });
        }

        // Timeline åˆå§‹åŒ–åŠŸèƒ½ - ç§»é™¤ï¼Œä½¿ç”¨ç¨ç«‹çš„è…³æœ¬æ¨™ç±¤

        // Exhibitor åˆå§‹åŒ–åŠŸèƒ½
        function initExhibitors() {
          // å»¶é²åŸ·è¡Œï¼Œç¢ºä¿ exhibitor-display.js å’Œ exhibitors-list.js å·²ç¶“è¼‰å…¥
          setTimeout(function () {
            console.log("åˆå§‹åŒ–æ”¤å•†åŠŸèƒ½");

            // åˆå§‹åŒ–æ”¤å•†é¡¯ç¤ºåŠŸèƒ½
            if (typeof ExhibitorDisplay === "function") {
              window.exhibitorDisplayInstance = new ExhibitorDisplay();
              console.log("æ”¤å•†é¡¯ç¤ºåŠŸèƒ½å·²åˆå§‹åŒ–");
            }

            // åˆå§‹åŒ–æ”¤å•†åå–®åŠŸèƒ½
            if (typeof ExhibitorsList === "function") {
              new ExhibitorsList();
              console.log("æ”¤å•†åå–®åŠŸèƒ½å·²åˆå§‹åŒ–");
            }

            // åˆå§‹åŒ–ç¯©é¸å™¨åŠŸèƒ½
            initExhibitorFilters();
            
            // åˆå§‹åŒ–æ–°çš„æœå°‹ç³»çµ±
            initExhibitorSearch();
            
            // åˆå§‹åŒ–ç„¦é»æ•ˆæœ
            initExhibitorFocusEffect();
          }, 1500); // å»¶é²1.5ç§’åŸ·è¡Œï¼Œç¢ºä¿æ‰€æœ‰ JS æ–‡ä»¶éƒ½å·²è¼‰å…¥
        }

        // æ”¤å•†ç¯©é¸å™¨åŠŸèƒ½
        function initExhibitorFilters() {
          const nameBtn = document.getElementById('sort-name-btn');
          const countryBtn = document.getElementById('sort-country-btn');
          const numberBtn = document.getElementById('sort-number-btn');

          // æŒ‰éˆ•é»æ“Šäº‹ä»¶
          if (nameBtn) {
            nameBtn.addEventListener('click', function() {
              setActiveButton(this);
              sortExhibitorsByName();
            });
          }

          if (countryBtn) {
            countryBtn.addEventListener('click', function() {
              setActiveButton(this);
              sortExhibitorsByCountry();
            });
          }

          if (numberBtn) {
            numberBtn.addEventListener('click', function() {
              setActiveButton(this);
              sortExhibitorsByNumber();
            });
          }

          // é è¨­æ’åºç‚ºå“ç‰Œåç¨± A-Z
          sortExhibitorsByName();
        }

        // æ–°çš„æœå°‹ç³»çµ±åŠŸèƒ½
        function initExhibitorSearch() {
          const searchInput = document.getElementById('exhibitor-search-input');
          const searchClearBtn = document.getElementById('search-clear-btn');
          const sortButtons = document.querySelectorAll('.sort-btn');

          // æœå°‹è¼¸å…¥æ¡†äº‹ä»¶
          if (searchInput) {
            searchInput.addEventListener('input', function() {
              performSearch();
            });
          }

          // æ¸…ç©ºæœå°‹æŒ‰éˆ•
          if (searchClearBtn) {
            searchClearBtn.addEventListener('click', function() {
              searchInput.value = '';
              performSearch();
            });
          }

          // æ’åºæŒ‰éˆ•äº‹ä»¶
          sortButtons.forEach(button => {
            button.addEventListener('click', function() {
              // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„activeé¡
              sortButtons.forEach(btn => btn.classList.remove('active'));
              // æ·»åŠ ç•¶å‰æŒ‰éˆ•çš„activeé¡
              this.classList.add('active');
              
              // åŸ·è¡Œæ’åº
              const sortType = this.getAttribute('data-label');
              performSort(sortType);
            });
          });

          // åŸ·è¡Œæœå°‹
          function performSearch() {
            const searchTerm = searchInput.value.toLowerCase().trim();

            // ç²å–æ‰€æœ‰æ”¤å•†å¡ç‰‡
            const exhibitorCards = document.querySelectorAll('.exhibitor-card-main');
            let visibleCount = 0;

            exhibitorCards.forEach(card => {
              const brandName = card.querySelector('.exhibitor-brand-display')?.textContent.toLowerCase() || '';
              const description = card.querySelector('.exhibitor-description')?.textContent.toLowerCase() || '';

              // æœå°‹æ¢ä»¶æª¢æŸ¥
              let matchesSearch = true;

              // æ–‡å­—æœå°‹
              if (searchTerm) {
                matchesSearch = brandName.includes(searchTerm) || 
                               description.includes(searchTerm);
              }

              // é¡¯ç¤ºæˆ–éš±è—å¡ç‰‡
              if (matchesSearch) {
                card.className = 'exhibitor-card-main visible';
                visibleCount++;
              } else {
                card.className = 'exhibitor-card-main hidden';
              }
            });

            // æ›´æ–°æœå°‹çµ±è¨ˆ
            updateSearchStats(visibleCount, exhibitorCards.length);
          }

          // åŸ·è¡Œæ’åº
          function performSort(sortType) {
            const container = document.getElementById('exhibitorDisplayContainer');
            if (!container) return;

            const gridContainer = container.querySelector('.exhibitors-grid-main');
            if (!gridContainer) return;

            const cards = Array.from(document.querySelectorAll('.exhibitor-card-main'));
            
            switch (sortType) {
              case 'atoz':
                // A-Z æ’åºï¼ˆæŒ‰å“ç‰Œåç¨±ï¼‰
                cards.sort((a, b) => {
                  const nameA = a.querySelector('.exhibitor-brand-display')?.textContent.trim() || '';
                  const nameB = b.querySelector('.exhibitor-brand-display')?.textContent.trim() || '';
                  return nameA.localeCompare(nameB, 'zh-TW', { numeric: true });
                });
                break;
                
              case 'zone':
                // ZONE æ’åºï¼ˆæŒ‰æ”¤ä½ç·¨è™Ÿï¼‰
                cards.sort((a, b) => {
                  const numberA = a.querySelector('.exhibitor-booth-display')?.textContent.trim() || '';
                  const numberB = b.querySelector('.exhibitor-booth-display')?.textContent.trim() || '';
                  
                  // æå–æ•¸å­—éƒ¨åˆ†é€²è¡Œæ’åº
                  const numA = parseInt(numberA.match(/\d+/)?.[0] || '0');
                  const numB = parseInt(numberB.match(/\d+/)?.[0] || '0');
                  
                  if (numA !== numB) {
                    return numA - numB;
                  }
                  
                  // å¦‚æœæ•¸å­—ç›¸åŒï¼ŒæŒ‰å®Œæ•´ç·¨è™Ÿæ’åº
                  return numberA.localeCompare(numberB);
                });
                break;
                
              case 'country':
                // COUNTRY æ’åºï¼ˆæŒ‰åœ‹ç±A-Zæ’åºï¼‰
                cards.sort((a, b) => {
                  const countryA = a.querySelector('.exhibitor-nationality-display')?.textContent.trim() || '';
                  const countryB = b.querySelector('.exhibitor-nationality-display')?.textContent.trim() || '';
                  
                  // æŒ‰åœ‹å®¶åç¨±A-Zæ’åº
                  return countryA.localeCompare(countryB, 'zh-TW', { numeric: true });
                });
                break;
                
              case 'length':
                // å­—æ•¸æ’åºï¼ˆæŒ‰å“ç‰Œåç¨±å­—æ•¸ï¼‰
                cards.sort((a, b) => {
                  const nameA = a.querySelector('.exhibitor-brand-display')?.textContent.trim() || '';
                  const nameB = b.querySelector('.exhibitor-brand-display')?.textContent.trim() || '';
                  
                  // æŒ‰å­—æ•¸æ’åºï¼ˆçŸ­åˆ°é•·ï¼‰
                  const lengthA = nameA.length;
                  const lengthB = nameB.length;
                  
                  if (lengthA !== lengthB) {
                    return lengthA - lengthB;
                  }
                  
                  // å¦‚æœå­—æ•¸ç›¸åŒï¼ŒæŒ‰A-Zæ’åº
                  return nameA.localeCompare(nameB, 'zh-TW', { numeric: true });
                });
                break;
            }

            // é‡æ–°æ’åˆ—å¡ç‰‡
            cards.forEach(card => gridContainer.appendChild(card));
            
            // åŸ·è¡Œæœå°‹ä»¥æ›´æ–°çµ±è¨ˆ
            performSearch();
          }

          // æ›´æ–°æœå°‹çµ±è¨ˆ - å·²ç§»é™¤é¡¯ç¤ºç¸½æ•¸åŠŸèƒ½
          function updateSearchStats(visibleCount, totalCount) {
            // åŠŸèƒ½å·²ç§»é™¤
          }
        }

        // åˆå§‹åŒ–åƒå±•å•†ç„¦é»æ•ˆæœ
        function initExhibitorFocusEffect() {
          // ä½¿ç”¨å®šæ™‚å™¨ç¢ºä¿åœ¨å¤–éƒ¨JSè¼‰å…¥å¾ŒåŸ·è¡Œ
          setTimeout(function() {
            // ç›£è½æ‰€æœ‰è©³ç´°è³‡è¨Šçš„å±•é–‹/æ”¶åˆ
            const observer = new MutationObserver(function(mutations) {
              mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                  const target = mutation.target;
                  if (target.classList.contains('exhibitor-details')) {
                    const card = target.closest('.exhibitor-card-main');
                    const allCards = document.querySelectorAll('.exhibitor-card-main');
                    
                    if (target.classList.contains('expanded')) {
                      // è©³ç´°è³‡è¨Šå±•é–‹æ™‚ï¼Œçµ¦å…¶ä»–å¡ç‰‡æ·»åŠ ç„¦é»æ•ˆæœ
                      console.log('æ”¤å•†å±•é–‹ï¼Œæ·»åŠ åç™½æ•ˆæœ');
                      console.log('æ‰¾åˆ°çš„å¡ç‰‡æ•¸é‡:', allCards.length);
                      allCards.forEach(c => {
                        if (c !== card) {
                          c.classList.add('focused-out');
                          console.log('æ·»åŠ  focused-out é¡åˆ¥åˆ°å¡ç‰‡:', c);
                        }
                      });
                    } else {
                      // è©³ç´°è³‡è¨Šæ”¶åˆæ™‚ï¼Œç§»é™¤æ‰€æœ‰ç„¦é»æ•ˆæœ
                      console.log('æ”¤å•†æ”¶åˆï¼Œç§»é™¤åç™½æ•ˆæœ');
                      allCards.forEach(c => {
                        c.classList.remove('focused-out');
                        console.log('ç§»é™¤ focused-out é¡åˆ¥å¾å¡ç‰‡:', c);
                      });
                    }
                  }
                }
              });
            });
            
            // é–‹å§‹è§€å¯Ÿæ‰€æœ‰è©³ç´°è³‡è¨Šå…ƒç´ 
            const detailsElements = document.querySelectorAll('.exhibitor-details');
            detailsElements.forEach(element => {
              observer.observe(element, { attributes: true });
            });
            
            console.log('åƒå±•å•†ç„¦é»æ•ˆæœå·²åˆå§‹åŒ–ï¼Œç›£è½', detailsElements.length, 'å€‹è©³ç´°è³‡è¨Šå…ƒç´ ');
          }, 2000); // å»¶é²2ç§’åŸ·è¡Œï¼Œç¢ºä¿å¤–éƒ¨JSå·²è¼‰å…¥
        }

        // è¨­ç½®æ´»å‹•æŒ‰éˆ•
        function setActiveButton(activeBtn) {
          const buttons = document.querySelectorAll('.filter-btn');
          buttons.forEach(btn => btn.classList.remove('active'));
          activeBtn.classList.add('active');
        }

        // å“ç‰Œåç¨± A-Z æ’åºï¼ˆä¸­æ–‡ç”¨æ³¨éŸ³æ’åºï¼‰
        function sortExhibitorsByName() {
          // æª¢æŸ¥æ˜¯å¦æœ‰ ExhibitorDisplay å¯¦ä¾‹ä¸¦é‡æ–°æ¸²æŸ“
          if (window.exhibitorDisplayInstance && typeof window.exhibitorDisplayInstance.showAllExhibitors === 'function') {
            window.exhibitorDisplayInstance.showAllExhibitors();
            return;
          }

          const container = document.getElementById('exhibitorDisplayContainer');
          if (!container) return;

          // æ‰¾åˆ°ç¶²æ ¼å®¹å™¨
          const gridContainer = container.querySelector('.exhibitors-grid-main');
          if (!gridContainer) return;

          const cards = Array.from(document.querySelectorAll('.exhibitor-card-main'));
          
          cards.sort((a, b) => {
            const nameA = a.querySelector('.exhibitor-name')?.textContent.trim() || '';
            const nameB = b.querySelector('.exhibitor-name')?.textContent.trim() || '';
            
            // ä½¿ç”¨ localeCompare é€²è¡Œä¸­æ–‡æ³¨éŸ³æ’åº
            return nameA.localeCompare(nameB, 'zh-TW', { numeric: true });
          });

          // æ¸…é™¤ç¾æœ‰å…§å®¹ä¸¦é‡æ–°æ’åˆ—
          gridContainer.innerHTML = '';
          cards.forEach(card => gridContainer.appendChild(card));
        }

        // åœ‹ç±æ’åºï¼ˆæŒ‰äº”å¤§æ´²åˆ†çµ„ï¼‰
        function sortExhibitorsByCountry() {
          // æª¢æŸ¥æ˜¯å¦æœ‰ ExhibitorDisplay å¯¦ä¾‹ä¸¦é‡æ–°æ¸²æŸ“
          if (window.exhibitorDisplayInstance && typeof window.exhibitorDisplayInstance.showAllExhibitors === 'function') {
            window.exhibitorDisplayInstance.showAllExhibitors();
            return;
          }

          const container = document.getElementById('exhibitorDisplayContainer');
          if (!container) return;

          // æ‰¾åˆ°ç¶²æ ¼å®¹å™¨
          const gridContainer = container.querySelector('.exhibitors-grid-main');
          if (!gridContainer) return;

          const cards = Array.from(document.querySelectorAll('.exhibitor-card-main'));
          
          // äº”å¤§æ´²é †åºå®šç¾©
          const continentOrder = {
            'ASIA': 1,
            'EUROPE': 2,
            'AMERICAS': 3,
            'AFRICA': 4,
            'OCEANIA': 5
          };

          // åœ‹ç±åˆ°æ´²çš„æ˜ å°„
          const countryToContinent = {
            'å°ç£': 'ASIA',
            'æ—¥æœ¬': 'ASIA',
            'éŸ“åœ‹': 'ASIA',
            'ä¸­åœ‹': 'ASIA',
            'é¦™æ¸¯': 'ASIA',
            'æ–°åŠ å¡': 'ASIA',
            'æ³°åœ‹': 'ASIA',
            'é¦¬ä¾†è¥¿äº': 'ASIA',
            'å°å°¼': 'ASIA',
            'è²å¾‹è³“': 'ASIA',
            'è¶Šå—': 'ASIA',
            'å°åº¦': 'ASIA',
            'å¾·åœ‹': 'EUROPE',
            'æ³•åœ‹': 'EUROPE',
            'è‹±åœ‹': 'EUROPE',
            'ç¾©å¤§åˆ©': 'EUROPE',
            'è¥¿ç­ç‰™': 'EUROPE',
            'è·è˜­': 'EUROPE',
            'ç‘å£«': 'EUROPE',
            'å¥§åœ°åˆ©': 'EUROPE',
            'æ¯”åˆ©æ™‚': 'EUROPE',
            'ä¸¹éº¥': 'EUROPE',
            'ç‘å…¸': 'EUROPE',
            'æŒªå¨': 'EUROPE',
            'èŠ¬è˜­': 'EUROPE',
            'ç¾åœ‹': 'AMERICAS',
            'åŠ æ‹¿å¤§': 'AMERICAS',
            'å¢¨è¥¿å“¥': 'AMERICAS',
            'å·´è¥¿': 'AMERICAS',
            'é˜¿æ ¹å»·': 'AMERICAS',
            'æ™ºåˆ©': 'AMERICAS',
            'ç§˜é­¯': 'AMERICAS',
            'å“¥å€«æ¯”äº': 'AMERICAS',
            'æ¾³æ´²': 'OCEANIA',
            'ç´è¥¿è˜­': 'OCEANIA',
            'æ–æ¿Ÿ': 'OCEANIA',
            'å—é': 'AFRICA',
            'åŸƒåŠ': 'AFRICA',
            'æ‘©æ´›å“¥': 'AFRICA',
            'è‚¯äº': 'AFRICA'
          };

          // æŒ‰æ´²åˆ†çµ„
          const groupedCards = {};
          cards.forEach(card => {
            const country = card.querySelector('.exhibitor-country')?.textContent.trim() || '';
            const continent = countryToContinent[country] || 'OTHER';
            
            if (!groupedCards[continent]) {
              groupedCards[continent] = [];
            }
            groupedCards[continent].push(card);
          });

          // æŒ‰æ´²é †åºæ’åˆ—ä¸¦æ·»åŠ åˆ†éš”æ¨™é¡Œ
          const sortedContinents = Object.keys(groupedCards).sort((a, b) => {
            const orderA = continentOrder[a] || 999;
            const orderB = continentOrder[b] || 999;
            return orderA - orderB;
          });

          sortedContinents.forEach(continent => {
            // æ·»åŠ æ´²æ¨™é¡Œ
            const titleDiv = document.createElement('div');
            titleDiv.className = 'continent-title';
            titleDiv.textContent = continent;
            gridContainer.appendChild(titleDiv);

            // æ·»åŠ åˆ†éš”ç·š
            const separatorDiv = document.createElement('div');
            separatorDiv.className = 'continent-separator';
            gridContainer.appendChild(separatorDiv);

            // æ’åºè©²æ´²å…§çš„æ”¤å•†
            const continentCards = groupedCards[continent];
            continentCards.sort((a, b) => {
              const countryA = a.querySelector('.exhibitor-country')?.textContent.trim() || '';
              const countryB = b.querySelector('.exhibitor-country')?.textContent.trim() || '';
              return countryA.localeCompare(countryB, 'zh-TW');
            });

            // æ·»åŠ è©²æ´²çš„æ”¤å•†å¡ç‰‡
            continentCards.forEach(card => gridContainer.appendChild(card));
          });
        }

        // æ”¤å•†ç·¨è™Ÿ A-Z æ’åº
        function sortExhibitorsByNumber() {
          // æª¢æŸ¥æ˜¯å¦æœ‰ ExhibitorDisplay å¯¦ä¾‹ä¸¦é‡æ–°æ¸²æŸ“
          if (window.exhibitorDisplayInstance && typeof window.exhibitorDisplayInstance.showAllExhibitors === 'function') {
            window.exhibitorDisplayInstance.showAllExhibitors();
            return;
          }

          const container = document.getElementById('exhibitorDisplayContainer');
          if (!container) return;

          // æ‰¾åˆ°ç¶²æ ¼å®¹å™¨
          const gridContainer = container.querySelector('.exhibitors-grid-main');
          if (!gridContainer) return;

          const cards = Array.from(document.querySelectorAll('.exhibitor-card-main'));
          
          cards.sort((a, b) => {
            const numberA = a.querySelector('.exhibitor-number')?.textContent.trim() || '';
            const numberB = b.querySelector('.exhibitor-number')?.textContent.trim() || '';
            
            // æå–æ•¸å­—éƒ¨åˆ†é€²è¡Œæ’åº
            const numA = parseInt(numberA.match(/\d+/)?.[0] || '0');
            const numB = parseInt(numberB.match(/\d+/)?.[0] || '0');
            
            if (numA !== numB) {
              return numA - numB;
            }
            
            // å¦‚æœæ•¸å­—ç›¸åŒï¼ŒæŒ‰å®Œæ•´ç·¨è™Ÿæ’åº
            return numberA.localeCompare(numberB);
          });

          // é‡æ–°æ’åˆ—å¡ç‰‡åˆ°ç¶²æ ¼å®¹å™¨
          cards.forEach(card => gridContainer.appendChild(card));
        }

        // åˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
        initLanguageSwitch();
        initFAQ();
        initSmoothScroll();
        initExhibitors();
        updateTicketStatus(); // æ›´æ–°ç¥¨åˆ¸ç‹€æ…‹
      });
      
      // æ”¤å•†å‹•æ…‹å¯¬åº¦å±•é–‹æ•ˆæœ
      setTimeout(() => {
        console.log('åˆå§‹åŒ–æ”¤å•†å‹•æ…‹å¯¬åº¦å±•é–‹æ•ˆæœ');
        
        // æª¢æŸ¥æ”¤å•†å¡ç‰‡æ˜¯å¦å­˜åœ¨
        const allCards = document.querySelectorAll('.exhibitor-card-main');
        console.log('æ‰¾åˆ°çš„æ”¤å•†å¡ç‰‡æ•¸é‡:', allCards.length);
        
        if (allCards.length === 0) {
          console.log('æ²’æœ‰æ‰¾åˆ°æ”¤å•†å¡ç‰‡ï¼Œå¯èƒ½æ•¸æ“šé‚„æ²’è¼‰å…¥ï¼Œç­‰å¾…æ›´é•·æ™‚é–“...');
          // å¦‚æœæ²’æœ‰æ‰¾åˆ°å¡ç‰‡ï¼Œå†ç­‰å¾… 2 ç§’
          setTimeout(() => {
            const retryCards = document.querySelectorAll('.exhibitor-card-main');
            console.log('é‡è©¦å¾Œæ‰¾åˆ°çš„æ”¤å•†å¡ç‰‡æ•¸é‡:', retryCards.length);
            
            if (retryCards.length === 0) {
              console.log('ä»ç„¶æ²’æœ‰æ‰¾åˆ°æ”¤å•†å¡ç‰‡ï¼Œè«‹æª¢æŸ¥æ•¸æ“šè¼‰å…¥');
              return;
            }
            
            // å¦‚æœæ‰¾åˆ°äº†å¡ç‰‡ï¼Œç¹¼çºŒåŸ·è¡Œ
            initExhibitorClickHandler();
          }, 2000);
          return;
        }
        
        // æª¢æŸ¥ç¬¬ä¸€å€‹å¡ç‰‡çš„çµæ§‹
        const firstCard = allCards[0];
        console.log('ç¬¬ä¸€å€‹å¡ç‰‡:', firstCard);
        console.log('ç¬¬ä¸€å€‹å¡ç‰‡çš„é¡åˆ¥:', firstCard.className);
        console.log('ç¬¬ä¸€å€‹å¡ç‰‡çš„è©³ç´°è³‡è¨Šå…ƒç´ :', firstCard.querySelector('.exhibitor-details'));
        
        // åˆå§‹åŒ–é»æ“Šè™•ç†å™¨
        initExhibitorClickHandler();
      }, 5000); // å¢åŠ å»¶é²æ™‚é–“åˆ° 5 ç§’
      
      function initExhibitorClickHandler() {
        console.log('åˆå§‹åŒ–æ”¤å•†é»æ“Šè™•ç†å™¨');
        
        // ä½¿ç”¨äº‹ä»¶å§”è¨—ï¼Œç›£è½æ•´å€‹æ–‡æª”çš„é»æ“Šäº‹ä»¶
        document.addEventListener('click', function(e) {
          console.log('é»æ“Šäº‹ä»¶:', e.target);
          console.log('é»æ“Šçš„ç›®æ¨™é¡åˆ¥:', e.target.className);
          
          // å°‹æ‰¾æœ€è¿‘çš„æ”¤å•†å¡ç‰‡
          const card = e.target.closest('.exhibitor-card-main');
          console.log('æ‰¾åˆ°çš„å¡ç‰‡:', card);
          
          if (!card) {
            console.log('æ²’æœ‰æ‰¾åˆ°æ”¤å•†å¡ç‰‡');
            return;
          }
          
          console.log('é»æ“Šäº†æ”¤å•†å¡ç‰‡:', card);
          
          // å°‹æ‰¾è©³ç´°è³‡è¨Šå…ƒç´ 
          const detailsElement = card.querySelector('.exhibitor-details');
          console.log('æ‰¾åˆ°çš„è©³ç´°è³‡è¨Šå…ƒç´ :', detailsElement);
          
          if (!detailsElement) {
            console.log('æ²’æœ‰æ‰¾åˆ°è©³ç´°è³‡è¨Šå…ƒç´ ');
            return;
          }
          
          console.log('æ‰¾åˆ°è©³ç´°è³‡è¨Šå…ƒç´ ');
          
          // æª¢æŸ¥æ˜¯å¦å·²ç¶“å±•é–‹
          const isExpanded = card.classList.contains('expanded-wide');
          console.log('æ˜¯å¦å·²å±•é–‹:', isExpanded);
          
          if (isExpanded) {
            // å¦‚æœå·²ç¶“å±•é–‹ï¼Œå‰‡æ”¶åˆ
            console.log('æ”¶åˆæ”¤å•†å¡ç‰‡');
            card.classList.remove('expanded-wide', 'long-content');
            detailsElement.classList.remove('expanded');
          } else {
            // å±•é–‹æ”¤å•†å¡ç‰‡
            console.log('å±•é–‹æ”¤å•†å¡ç‰‡');
            
            // è¨ˆç®— description çš„é•·åº¦ä¾†æ±ºå®šä½”æ“šå¤šå°‘å¯¬åº¦
            const descriptionElement = card.querySelector('.exhibitor-description');
            const contentText = descriptionElement ? descriptionElement.textContent || '' : '';
            const contentLength = contentText.length;
            
            console.log('Description å…§å®¹:', contentText);
            console.log('Description é•·åº¦:', contentLength);
            
            // æ·»åŠ å±•é–‹é¡åˆ¥
            card.classList.add('expanded-wide');
            detailsElement.classList.add('expanded');
            
            // å¦‚æœ description å¾ˆé•·ï¼Œä½”æ“š 3 åˆ—å¯¬åº¦
            if (contentLength > 100) {
              card.classList.add('long-content');
              console.log('Description è¼ƒé•·ï¼Œä½”æ“š 3 åˆ—å¯¬åº¦');
            } else {
              console.log('Description ä¸€èˆ¬ï¼Œä½”æ“š 2 åˆ—å¯¬åº¦');
            }
            
            // æ·»åŠ éš¨æ©ŸèƒŒæ™¯è‰²ï¼ˆåªåœ¨ç¬¬ä¸€æ¬¡é»æ“Šæ™‚æ·»åŠ ï¼‰
            console.log('æª¢æŸ¥æ˜¯å¦å·²æœ‰é¡è‰²:', card.dataset.hasColor);
            if (!card.dataset.hasColor) {
              const highlightColors = [
                'yellowgreen',
                'yellow',
                'cyan',
                'orangered',
                'magenta',
                'pink',
                'rgb(52, 77, 203)',
                'forestgreen'
              ];
              
              const randomColor = highlightColors[Math.floor(Math.random() * highlightColors.length)];
              console.log('é¸æ“‡çš„éš¨æ©Ÿé¡è‰²:', randomColor);
              card.style.backgroundColor = randomColor;
              card.dataset.hasColor = 'true';
              console.log('æ·»åŠ éš¨æ©ŸèƒŒæ™¯è‰²:', randomColor);
              console.log('å¡ç‰‡ç¾åœ¨çš„èƒŒæ™¯è‰²:', card.style.backgroundColor);
            } else {
              console.log('å¡ç‰‡å·²ç¶“æœ‰é¡è‰²ï¼Œè·³é');
            }
          }
        });
      }
    </script>
    <script>
      // å›åˆ°é ‚éƒ¨æŒ‰éˆ•åŠŸèƒ½
      document.addEventListener('DOMContentLoaded', function() {
        const backToTopBtn = document.getElementById('backToTop');
        
        // é¡¯ç¤º/éš±è—æŒ‰éˆ•ï¼ˆç•¶é é¢å‘ä¸‹æ»¾å‹•è¶…é 300px æ™‚é¡¯ç¤ºï¼‰
        function toggleBackToTop() {
          if (window.pageYOffset > 300) {
            backToTopBtn.style.display = 'flex';
          } else {
            backToTopBtn.style.display = 'none';
          }
        }
        
        // å¹³æ»‘æ»¾å‹•åˆ°é ‚éƒ¨
        function scrollToTop() {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        }
        
        // ç›£è½æ»¾å‹•äº‹ä»¶
        window.addEventListener('scroll', toggleBackToTop);
        
        // é»æ“ŠæŒ‰éˆ•æ»¾å‹•åˆ°é ‚éƒ¨
        backToTopBtn.addEventListener('click', scrollToTop);
        
        // åˆå§‹åŒ–éš±è—æŒ‰éˆ•
        backToTopBtn.style.display = 'none';
      });
    </script>
    <script>
      // åœ°åœ–æµ®å‹•è¦–çª—æ‹–å‹•å’Œèª¿æ•´å¤§å°åŠŸèƒ½
      document.addEventListener('DOMContentLoaded', function() {
        const mapContainer = document.getElementById('exhibitor-map-container');
        const mapHeader = mapContainer?.querySelector('.exhibitor-map-header');
        const mapCloseBtn = document.getElementById('map-close-btn');
        const resizeHandle = mapContainer?.querySelector('.exhibitor-map-resize-handle');
        const parentContainer = mapContainer?.closest('.exhibitor-info-content');
        
        if (!mapContainer || !parentContainer) return;
        
        // æª¢æ¸¬æ˜¯å¦ç‚ºæ‰‹æ©Ÿç‰ˆæˆ–å¹³æ¿ç‰ˆ
        function isMobileOrTablet() {
          return window.innerWidth <= 1024;
        }
        
        // å¦‚æœç‚ºæ‰‹æ©Ÿç‰ˆæˆ–å¹³æ¿ç‰ˆï¼Œä¸å•Ÿç”¨æ‹–å‹•å’Œèª¿æ•´å¤§å°åŠŸèƒ½
        if (isMobileOrTablet()) {
          return;
        }
        
        let isDragging = false;
        let isResizing = false;
        let startX, startY, startWidth, startHeight, startLeft, startTop;
        let aspectRatio = 1; // åœ°åœ–çš„å¯¬é«˜æ¯”
        
        // ç²å–åœ°åœ–åœ–ç‰‡çš„åŸå§‹å¯¬é«˜æ¯”
        const mapImage = mapContainer.querySelector('.exhibitor-map-image');
        if (mapImage) {
          mapImage.addEventListener('load', function() {
            aspectRatio = mapImage.naturalWidth / mapImage.naturalHeight;
            // å¦‚æœåœ–ç‰‡é‚„æ²’è¼‰å…¥ï¼Œä½¿ç”¨ç•¶å‰å®¹å™¨çš„å¯¬é«˜æ¯”
            if (!aspectRatio || aspectRatio === 0) {
              aspectRatio = mapContainer.offsetWidth / mapContainer.offsetHeight;
            }
          });
          // å¦‚æœåœ–ç‰‡å·²ç¶“è¼‰å…¥
          if (mapImage.complete) {
            aspectRatio = mapImage.naturalWidth / mapImage.naturalHeight;
            if (!aspectRatio || aspectRatio === 0) {
              aspectRatio = mapContainer.offsetWidth / mapContainer.offsetHeight;
            }
          } else {
            // ä½¿ç”¨ç•¶å‰å®¹å™¨çš„å¯¬é«˜æ¯”ä½œç‚ºåˆå§‹å€¼
            aspectRatio = mapContainer.offsetWidth / mapContainer.offsetHeight;
          }
        }
        
        // ç²å–çˆ¶å®¹å™¨çš„é‚Šç•Œï¼ˆç›¸å°æ–¼è¦–çª—ï¼‰
        function getParentBounds() {
          const parentRect = parentContainer.getBoundingClientRect();
          return {
            left: parentRect.left,
            top: parentRect.top,
            right: parentRect.right,
            bottom: parentRect.bottom,
            width: parentRect.width,
            height: parentRect.height
          };
        }
        
        // æ‹–å‹•åŠŸèƒ½ - æ•´å€‹åœ°åœ–å®¹å™¨éƒ½å¯ä»¥æ‹–å‹•
        mapContainer.addEventListener('mousedown', function(e) {
          // å¦‚æœé»æ“Šçš„æ˜¯èª¿æ•´å¤§å°æ‰‹æŸ„ï¼Œä¸è§¸ç™¼æ‹–å‹•
          if (e.target === resizeHandle || e.target.closest('.exhibitor-map-resize-handle')) {
            return;
          }
          // å¦‚æœé»æ“Šçš„æ˜¯é—œé–‰æŒ‰éˆ•ï¼Œä¸è§¸ç™¼æ‹–å‹•
          if (e.target === mapCloseBtn || e.target.closest('.exhibitor-map-close')) {
            return;
          }
          
          isDragging = true;
          startX = e.clientX;
          startY = e.clientY;
          const mapRect = mapContainer.getBoundingClientRect();
          const parentRect = parentContainer.getBoundingClientRect();
          // è¨ˆç®—ç›¸å°æ–¼çˆ¶å®¹å™¨çš„ä½ç½®
          startLeft = mapRect.left - parentRect.left;
          startTop = mapRect.top - parentRect.top;
          
          e.preventDefault();
        });
        
        // èª¿æ•´å¤§å°åŠŸèƒ½
        if (resizeHandle) {
          resizeHandle.addEventListener('mousedown', function(e) {
            isResizing = true;
            startX = e.clientX;
            startY = e.clientY;
            startWidth = parseInt(window.getComputedStyle(mapContainer).width, 10);
            startHeight = parseInt(window.getComputedStyle(mapContainer).height, 10);
            
            // ç¢ºä¿ä½¿ç”¨ç•¶å‰çš„å¯¬é«˜æ¯”
            if (mapImage && mapImage.complete && mapImage.naturalWidth && mapImage.naturalHeight) {
              aspectRatio = mapImage.naturalWidth / mapImage.naturalHeight;
            } else {
              aspectRatio = startWidth / startHeight;
            }
            
            e.preventDefault();
            e.stopPropagation();
          });
        }
        
        // é¼ æ¨™ç§»å‹•äº‹ä»¶
        document.addEventListener('mousemove', function(e) {
          if (isDragging && !isResizing) {
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            const parentBounds = getParentBounds();
            const mapRect = mapContainer.getBoundingClientRect();
            
            // è¨ˆç®—æ–°çš„ä½ç½®ï¼ˆç›¸å°æ–¼çˆ¶å®¹å™¨ï¼‰
            let newLeft = startLeft + deltaX;
            let newTop = startTop + deltaY;
            
            // é™åˆ¶åœ¨çˆ¶å®¹å™¨ç¯„åœå…§
            const minLeft = 0;
            const minTop = 0;
            const maxLeft = parentBounds.width - mapContainer.offsetWidth;
            const maxTop = parentBounds.height - mapContainer.offsetHeight;
            
            newLeft = Math.max(minLeft, Math.min(newLeft, maxLeft));
            newTop = Math.max(minTop, Math.min(newTop, maxTop));
            
            mapContainer.style.left = newLeft + 'px';
            mapContainer.style.top = newTop + 'px';
            mapContainer.style.right = 'auto';
            mapContainer.style.bottom = 'auto';
          } else if (isResizing) {
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            const parentBounds = getParentBounds();
            const mapRect = mapContainer.getBoundingClientRect();
            const currentLeft = mapRect.left - parentBounds.left;
            const currentTop = mapRect.top - parentBounds.top;
            
            // ç­‰æ¯”ä¾‹ç¸®æ”¾ï¼šä½¿ç”¨deltaXå’ŒdeltaYä¸­è¼ƒå¤§çš„è®ŠåŒ–é‡ä¾†ä¿æŒæ¯”ä¾‹
            // é€™æ¨£å¯ä»¥ç¢ºä¿ç„¡è«–æ‹–å‹•æ–¹å‘å¦‚ä½•ï¼Œéƒ½èƒ½ä¿æŒç­‰æ¯”ä¾‹
            const delta = Math.abs(deltaX) > Math.abs(deltaY) ? deltaX : deltaY;
            
            // æ ¹æ“šè®ŠåŒ–é‡è¨ˆç®—æ–°çš„å¯¬åº¦ï¼Œç„¶å¾Œæ ¹æ“šå¯¬é«˜æ¯”è¨ˆç®—é«˜åº¦
            let newWidth = startWidth + delta;
            let newHeight = newWidth / aspectRatio;
            
            // é™åˆ¶æœ€å°å’Œæœ€å¤§å°ºå¯¸
            const minWidth = 400;
            const minHeight = minWidth / aspectRatio;
            const maxWidth = Math.min(parentBounds.width - currentLeft, parentBounds.width - 40);
            const maxHeight = Math.min(parentBounds.height - currentTop, parentBounds.height - 40);
            
            // æª¢æŸ¥æ˜¯å¦è¶…å‡ºçˆ¶å®¹å™¨ç¯„åœ
            if (newWidth > maxWidth) {
              newWidth = maxWidth;
              newHeight = newWidth / aspectRatio;
            }
            if (newHeight > maxHeight) {
              newHeight = maxHeight;
              newWidth = newHeight * aspectRatio;
            }
            
            // ç¢ºä¿ä¸å°æ–¼æœ€å°å°ºå¯¸
            if (newWidth < minWidth) {
              newWidth = minWidth;
              newHeight = newWidth / aspectRatio;
            }
            if (newHeight < minHeight) {
              newHeight = minHeight;
              newWidth = newHeight * aspectRatio;
            }
            
            mapContainer.style.width = newWidth + 'px';
            mapContainer.style.height = newHeight + 'px';
          }
        });
        
        // é¼ æ¨™é‡‹æ”¾äº‹ä»¶
        document.addEventListener('mouseup', function() {
          isDragging = false;
          isResizing = false;
        });
        
        // é—œé–‰æŒ‰éˆ•åŠŸèƒ½
        if (mapCloseBtn) {
          mapCloseBtn.addEventListener('click', function() {
            mapContainer.style.display = 'none';
          });
        }
        
        // çª—å£å¤§å°æ”¹è®Šæ™‚ï¼Œå¦‚æœæ˜¯æ‰‹æ©Ÿç‰ˆæˆ–å¹³æ¿ç‰ˆå‰‡é‡ç½®æ¨£å¼
        window.addEventListener('resize', function() {
          if (isMobileOrTablet()) {
            mapContainer.style.left = '';
            mapContainer.style.top = '';
            mapContainer.style.right = '';
            mapContainer.style.width = '';
            mapContainer.style.height = '';
          } else {
            // æ¡Œé¢ç‰ˆï¼šç¢ºä¿åœ°åœ–ä»åœ¨çˆ¶å®¹å™¨ç¯„åœå…§
            const parentBounds = getParentBounds();
            const mapRect = mapContainer.getBoundingClientRect();
            const currentLeft = mapRect.left - parentBounds.left;
            const currentTop = mapRect.top - parentBounds.top;
            
            // å¦‚æœè¶…å‡ºç¯„åœï¼Œèª¿æ•´ä½ç½®
            if (currentLeft + mapContainer.offsetWidth > parentBounds.width) {
              mapContainer.style.left = (parentBounds.width - mapContainer.offsetWidth) + 'px';
            }
            if (currentTop + mapContainer.offsetHeight > parentBounds.height) {
              mapContainer.style.top = (parentBounds.height - mapContainer.offsetHeight) + 'px';
            }
            if (currentLeft < 0) {
              mapContainer.style.left = '0px';
            }
            if (currentTop < 0) {
              mapContainer.style.top = '0px';
            }
          }
        });
      });
    </script>
    <script src="js/timeline-visit.js"></script>
    <script src="js/exhibitors-list.js"></script>
    <script src="js/exhibitor-display.js"></script>
    
  </body>
  
  <style>
    .coming-soon-mask {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255,255,255);
      z-index: 99;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.2rem;
      font-weight: bold;
      color: #222;
      letter-spacing: 0.1em;
      pointer-events: all;
    }
    .timeline-section, .exhibitor-section {
      position: relative;
    }
  </style>
</html>
